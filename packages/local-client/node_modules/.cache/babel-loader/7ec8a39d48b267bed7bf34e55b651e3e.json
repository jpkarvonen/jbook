{"ast":null,"code":"import produce from'immer';import{ActionType}from'../action-types';var initialState={loading:false,error:null,order:[],data:{}};var reducer=produce(function(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case ActionType.UPDATE_CELL:var _action$payload=action.payload,id=_action$payload.id,content=_action$payload.content;state.data[id].content=content;return state;case ActionType.DELETE_CELL:delete state.data[action.payload];state.order=state.order.filter(function(id){return id!==action.payload;});return state;case ActionType.MOVE_CELL:var direction=action.payload.direction;var index=state.order.findIndex(function(id){return id===action.payload.id;});var targetIndex=direction==='up'?index-1:index+1;if(targetIndex<0||targetIndex>state.order.length-1){return state;}state.order[index]=state.order[targetIndex];state.order[targetIndex]=action.payload.id;return state;case ActionType.INSERT_CELL_AFTER:var cell={content:'',type:action.payload.type,id:randomId()};state.data[cell.id]=cell;var foundIndex=state.order.findIndex(function(id){return id===action.payload.id;});if(foundIndex<0){state.order.unshift(cell.id);}else{state.order.splice(foundIndex+1,0,cell.id);}return state;default:return state;}});var randomId=function randomId(){return Math.random().toString(36).substring(2,7);};export default reducer;","map":{"version":3,"sources":["/Users/karvonen/Valet/udemy-port/jbook/packages/local-client/src/state/reducers/cellsReducer.ts"],"names":["produce","ActionType","initialState","loading","error","order","data","reducer","state","action","type","UPDATE_CELL","payload","id","content","DELETE_CELL","filter","MOVE_CELL","direction","index","findIndex","targetIndex","length","INSERT_CELL_AFTER","cell","randomId","foundIndex","unshift","splice","Math","random","toString","substring"],"mappings":"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","sourcesContent":["import produce from 'immer';\nimport { ActionType } from '../action-types';\nimport { Action } from '../actions';\nimport { Cell } from '../cell';\n\ninterface CellsState {\n  loading: boolean;\n  error: string | null;\n  order: string[];\n  data: {\n    [key: string]: Cell;\n  };\n}\n\nconst initialState: CellsState = {\n  loading: false,\n  error: null,\n  order: [],\n  data: {},\n};\n\nconst reducer = produce(\n  (state: CellsState = initialState, action: Action): CellsState => {\n    switch (action.type) {\n      case ActionType.UPDATE_CELL:\n        const { id, content } = action.payload;\n\n        state.data[id].content = content;\n\n        return state;\n      case ActionType.DELETE_CELL:\n        delete state.data[action.payload];\n        state.order = state.order.filter((id) => id !== action.payload);\n\n        return state;\n      case ActionType.MOVE_CELL:\n        const { direction } = action.payload;\n        const index = state.order.findIndex((id) => id === action.payload.id);\n        const targetIndex = direction === 'up' ? index - 1 : index + 1;\n\n        if (targetIndex < 0 || targetIndex > state.order.length - 1) {\n          return state;\n        }\n\n        state.order[index] = state.order[targetIndex];\n        state.order[targetIndex] = action.payload.id;\n\n        return state;\n      case ActionType.INSERT_CELL_AFTER:\n        const cell: Cell = {\n          content: '',\n          type: action.payload.type,\n          id: randomId(),\n        };\n\n        state.data[cell.id] = cell;\n\n        const foundIndex = state.order.findIndex(\n          (id) => id === action.payload.id\n        );\n\n        if (foundIndex < 0) {\n          state.order.unshift(cell.id);\n        } else {\n          state.order.splice(foundIndex + 1, 0, cell.id);\n        }\n\n        return state;\n      default:\n        return state;\n    }\n  }\n);\n\nconst randomId = () => {\n  return Math.random().toString(36).substring(2, 7);\n};\n\nexport default reducer;\n"]},"metadata":{},"sourceType":"module"}